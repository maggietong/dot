import traceback
import sys

try:
    import pudb as debugger
except ImportError:
    import pdb as debugger

def drop_debugger(type, value, tb):
    if sys.stderr.isatty():
        traceback.print_exception(type, value, tb)
        debug = raw_input('Debug? [Y/n]: ')
        if debug == '':
            debug = 'y'
        debug = debug.lower()[0]
        if debug == 'y':
            debugger.pm()
    else:
        sys.__excepthook__(type, value, tb)

sys.excepthook = drop_debugger

__builtins__['debugger'] = debugger
__builtins__['st'] = debugger.set_trace
